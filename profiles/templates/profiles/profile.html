{% extends 'base.html' %}
{% load static %}
{% load materializecss %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'profiles/css/profile.css' %}">
{% endblock %}

{% block content %}
<style>
    .cycle-days {
        display: inline-block;
        border-style: double;
        border-width:  2px;
        border-color: black;
        border-radius: 10px;
        width: calc({{span_width}}%);
        height: 60px;
    }
    #today {
        width: calc({{span_width}}% * 1.5);
        height: calc({{span_width}}% * 1.5)
    }
</style>
<div class="row card-panel header-card">
    <div class="lime accent-3 col m2 offset-m5">
        <h3 class="center">Welcome Back {{ user }}</h3>
    </div>
</div>
<div class="container">
    <div class="container period-form">
        <ul class="collapsible">
            <li>
                <!-- edit date select so they can't select earlier than a month. If they only update th length it'll throw off day calculation -->
                <div class="collapsible-header lime accent-3"><i class="material-icons">date_range</i>Edit Cycle Start Date</div>
                <div class="collapsible-body">
                    <span>
                        <p class="lime-text text-accent-3">
                            Your current cycle started on {{ period_details.period_start_date }}
                        </p>
                        <form action="{% url 'profile' %}" method="POST" id="period_date">
                            {% csrf_token %}
                            {{ form.period_start_date|materializecss }}
                            <button type="sumbit" class="lime accent-3">Submit</button>
                        </form>
                    </span>
                </div>
            </li>
            <li>
                <div class="collapsible-header lime accent-3"><i class="material-icons">access_time</i>Edit Cycle Length</div>
                <div class="collapsible-body">
                    <span>
                        <p class="lime-text text-accent-3">
                            Your cycle is set to last for {{ period_details.period_length }} days
                        </p>
                        <form action="{% url 'profile' %}" method="POST" id="period_length">
                            {% csrf_token %}
                            {{ form.period_length|materializecss }}
                            <button type="sumbit" class="lime accent-3">Submit</button>
                        </form>
                    </span>
                </div>
            </li>
        </ul>
    </div>
    <!-- if period-info, display -->
</div>
<div class="container">
    <div class="row">
        <h4 class="center lime-text text-accent-3">
            Your Cycle
        </h4>
    </div>
    <div class="row">
        <!-- <span id="day-arrow" class="lime-text text-accent-3">
            <p>You are here</p>
            <i class="material-icons">arrow_downward</i>
        </span> -->
    </div>
    <div class="row center">
        <div class="valign-wrapper">
            {% for day in days %}
                {% if day < 6 %}
                    <span id="{% if day == cycle_day %}today{% else %}day-{{ day }}{% endif %}" class="cycle-days mensis center">
                        <p>Day<br> {{ day }}</p>
                    </span>
                {% elif day > 5 and day < mid_follicular %}
                    <span id="{% if day == cycle_day %}today{% else %}day-{{ day }}{% endif %}" class="cycle-days follicular-1 center">
                        <p>Day<br> {{ day }}</p>
                    </span>
                {% elif day > mid_follicular and day < ovulation %}
                    <span id="{% if day == cycle_day %}today{% else %}day-{{ day }}{% endif %}" class="cycle-days follicular-2 center">
                        <p>Day<br> {{ day }}</p>
                    </span>
                {% elif day == ovulation %}
                    <span id="{% if day == cycle_day %}today{% else %}day-{{ day }}{% endif %}" class="cycle-days ovulation center">
                        <p>Day<br> {{ day }}</p>
                    </span>
                {% elif day > ovulation and day < mid_luteal %}
                    <span id="{% if day == cycle_day %}today{% else %}day-{{ day }}{% endif %}" class="cycle-days luteal-1 center">
                        <p>Day<br> {{ day }}</p>
                    </span>
                {% elif day > mid_luteal %}
                    <span id="{% if day == cycle_day %}today{% else %}day-{{ day }}{% endif %}" class="cycle-days luteal-3 center">
                        <p>Day<br> {{ day }}</p>
                    </span>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block postloadjs %}
    <!-- <script type="text/javascript">
        var label = document.createElement('label');
        label.innerHTML = "More info";    
        document.getElementById('today').appendChild(label);
    </script> -->
{% endblock %}